@using Microsoft.AspNetCore.Identity
@using Microsoft.AspNetCore.Authorization
@using CitasEPS.Models

@inject SignInManager<User> SignInManager
@inject UserManager<User> UserManager
@inject IAuthorizationService AuthorizationService

@{
    var isDoctorLoggedIn = (bool)(ViewData["IsDoctorLoggedIn"] ?? false);
    var isPatientLoggedIn = (bool)(ViewData["IsPatientLoggedIn"] ?? false);
    var isAdminLoggedIn = (bool)(ViewData["IsAdminLoggedIn"] ?? false);
}

<header class="sticky-top">
    <nav class="navbar navbar-expand-xl">
        <div class="container-fluid">
            @* LOGO - REDIRECCI√ìN BASADA EN ROL *@
            @if (isAdminLoggedIn)
            {
                <a class="navbar-brand d-flex align-items-center" asp-area="" asp-page="/UserDashboards/Admin/Index" style="font-size: 1.3rem; font-weight: 700;">
                    <i class="bi bi-heart-pulse-fill me-2 brand-icon" style="font-size: 1.4rem; color: #dc3545;"></i> 
                    <span class="brand-text-vital">Vital</span><span class="brand-text-care">Care</span>
                </a>
            }
            else if (isDoctorLoggedIn)
            {
                <a class="navbar-brand d-flex align-items-center" asp-area="" asp-page="/UserDashboards/Doctor/Index" style="font-size: 1.3rem; font-weight: 700;">
                    <i class="bi bi-heart-pulse-fill me-2 brand-icon" style="font-size: 1.4rem; color: #dc3545;"></i> 
                    <span class="brand-text-vital">Vital</span><span class="brand-text-care">Care</span>
                </a>
            }
            else if (isPatientLoggedIn)
            {
                <a class="navbar-brand d-flex align-items-center" asp-area="" asp-page="/UserDashboards/Patient/Index" style="font-size: 1.3rem; font-weight: 700;">
                    <i class="bi bi-heart-pulse-fill me-2 brand-icon" style="font-size: 1.4rem; color: #dc3545;"></i> 
                    <span class="brand-text-vital">Vital</span><span class="brand-text-care">Care</span>
                </a>
            }
            else
            {
                <a class="navbar-brand d-flex align-items-center" asp-area="" asp-page="/Public/Index" style="font-size: 1.3rem; font-weight: 700;">
                    <i class="bi bi-heart-pulse-fill me-2 brand-icon" style="font-size: 1.4rem; color: #dc3545;"></i> 
                    <span class="brand-text-vital">Vital</span><span class="brand-text-care">Care</span>
                </a>
            }
            
            @* CONTROLES M√ìVILES (HAMBURGUESA + TEMA) *@
            <div class="d-xl-none d-flex align-items-center gap-2">
                @if (!SignInManager.IsSignedIn(User))
                {
                    <button class="btn btn-theme-toggle" type="button" id="themeToggleBtnMobile" title="Cambiar tema">
                        <i class="bi bi-sun-fill" id="themeIconSunMobile"></i>
                        <i class="bi bi-moon-stars-fill" id="themeIconMoonMobile" style="display:none;"></i>
                    </button>
                }
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            
            @* MEN√ö PRINCIPAL *@
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                @* NAVEGACI√ìN PRINCIPAL *@
                <ul class="navbar-nav me-auto mb-2 mb-xl-0 ms-4">
                    @* INICIO - REDIRECCI√ìN BASADA EN ROL *@
                    <li class="nav-item nav-item-important">
                        @if (isAdminLoggedIn)
                        {
                            <a class="nav-link d-flex align-items-center" asp-area="" asp-page="/UserDashboards/Admin/Index">
                                <i class="bi bi-house-door-fill me-2"></i> Inicio
                            </a>
                        }
                        else if (isDoctorLoggedIn)
                        {
                            <a class="nav-link d-flex align-items-center" asp-area="" asp-page="/UserDashboards/Doctor/Index">
                                <i class="bi bi-house-door-fill me-2"></i> Inicio
                            </a>
                        }
                        else if (isPatientLoggedIn)
                        {
                            <a class="nav-link d-flex align-items-center" asp-area="" asp-page="/UserDashboards/Patient/Index">
                                <i class="bi bi-house-door-fill me-2"></i> Inicio
                            </a>
                        }
                        else
                        {
                            <a class="nav-link d-flex align-items-center" asp-area="" asp-page="/Public/Index">
                                <i class="bi bi-house-door-fill me-2"></i> Inicio
                            </a>
                        }
                    </li>

                    @if (SignInManager.IsSignedIn(User))
                    {
                        @if (isAdminLoggedIn)
                        {
                            @* ADMIN - OPCIONES PRINCIPALES *@
                            <li class="nav-item nav-item-important">
                                <a class="nav-link d-flex align-items-center" asp-page="/Admin/ManageUsers">
                                    <i class="bi bi-person-gear me-2"></i> Administraci√≥n
                                </a>
                            </li>
                            <li class="nav-item nav-item-important">
                                <a class="nav-link d-flex align-items-center" asp-page="/Admin/ManageAppointments">
                                    <i class="bi bi-calendar-check-fill me-2"></i> Gestionar Citas
                                </a>
                            </li>
                            <li class="nav-item nav-item-important">
                                <a class="nav-link d-flex align-items-center" asp-page="/Admin/ManageDoctors">
                                    <i class="bi bi-file-medical-fill me-2"></i> Gestionar M√©dicos
                                </a>
                            </li>
                            <li class="nav-item nav-item-important">
                                <a class="nav-link d-flex align-items-center" asp-page="/Admin/ManagePatients">
                                    <i class="bi bi-person-lines-fill me-2"></i> Gestionar Pacientes
                                </a>
                            </li>
                            <li class="nav-item nav-item-important">
                                <a class="nav-link d-flex align-items-center" asp-page="/Admin/Medications/Index">
                                    <i class="bi bi-capsule-pill me-2"></i> Medicamentos
                                </a>
                            </li>
                            @* ENLACE TEMPORAL PARA CONFIRMACI√ìN DE EMAILS *@
                            <li class="nav-item nav-item-important">
                                <a class="nav-link d-flex align-items-center text-warning" asp-page="/Admin/ConfirmEmails">
                                    <i class="bi bi-envelope-exclamation me-2"></i> 
                                    <span class="small">‚öôÔ∏è Confirmar Emails</span>
                                </a>
                            </li>
                            @* ENLACE TEMPORAL PARA DIAGN√ìSTICO *@
                            <li class="nav-item nav-item-important">
                                <a class="nav-link d-flex align-items-center text-info" asp-page="/Admin/DiagnosticData">
                                    <i class="bi bi-tools me-2"></i> 
                                    <span class="small">üîß Diagn√≥stico BD</span>
                                </a>
                            </li>
                        } 
                        else if (isDoctorLoggedIn)
                        {
                            @* DOCTOR - OPCIONES PRINCIPALES *@
                            <li class="nav-item nav-item-important">
                                <a class="nav-link d-flex align-items-center" asp-page="/Doctor/Patients">
                                    <i class="bi bi-person-badge-fill me-2"></i> Mis Pacientes
                                </a>
                            </li>
                            <li class="nav-item nav-item-important">
                                <a class="nav-link d-flex align-items-center" asp-page="/Appointments/Index">
                                    <i class="bi bi-calendar-event me-2"></i> Ver Citas
                                </a>
                            </li>
                            @* MEN√ö M√ÅS PARA DOCTOR *@
                            <li class="nav-item dropdown nav-item-important">
                                <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    <i class="bi bi-three-dots me-2"></i> M√°s
                                </a>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item d-flex align-items-center" asp-area="" asp-page="/Public/Servicios">
                                        <i class="bi bi-gear-fill me-2"></i> Servicios
                                    </a></li>
                                    <li><a class="dropdown-item d-flex align-items-center" asp-area="" asp-page="/Public/About">
                                        <i class="bi bi-building me-2"></i> Sobre Nosotros
                                    </a></li>
                                    <li><a class="dropdown-item d-flex align-items-center" asp-area="" asp-page="/Public/Team">
                                        <i class="bi bi-people-fill me-2"></i> Equipo
                                    </a></li>
                                    <li><a class="dropdown-item d-flex align-items-center" asp-area="" asp-page="/Public/Contact">
                                        <i class="bi bi-envelope-fill me-2"></i> Contacto
                                    </a></li>
                                    <li><a class="dropdown-item d-flex align-items-center" asp-area="" asp-page="/Public/Support">
                                        <i class="bi bi-headset me-2"></i> Soporte T√©cnico
                                    </a></li>
                                    <li><a class="dropdown-item d-flex align-items-center" asp-area="" asp-page="/Public/FAQ">
                                        <i class="bi bi-question-circle-fill me-2"></i> FAQ
                                    </a></li>
                                </ul>
                            </li>
                        } 
                        else if (isPatientLoggedIn)
                        {
                            @* PACIENTE - OPCIONES PRINCIPALES *@
                            <li class="nav-item nav-item-important">
                                <a class="nav-link d-flex align-items-center" asp-page="/Appointments/Create">
                                    <i class="bi bi-calendar-plus-fill me-2"></i> Agendar Cita
                                </a>
                            </li>
                            <li class="nav-item nav-item-important">
                                <a class="nav-link d-flex align-items-center" asp-page="/Appointments/Index">
                                    <i class="bi bi-calendar-event-fill me-2"></i> Mis Citas
                                </a>
                            </li>
                            <li class="nav-item nav-item-important">
                                <a class="nav-link d-flex align-items-center" asp-page="/Appointments/MyPrescriptions">
                                    <i class="bi bi-journal-medical me-2"></i> Mis Recetas
                                </a>
                            </li>
                            <li class="nav-item nav-item-important">
                                <a class="nav-link d-flex align-items-center" asp-page="/Patient/HealthStatus">
                                    <i class="bi bi-heart-pulse-fill me-2"></i> Mi Salud
                                </a>
                            </li>
                        }
                    }
                    else
                    {
                        @* USUARIOS NO LOGUEADOS - OPCIONES PRINCIPALES *@
                        <li class="nav-item nav-item-important">
                            <a class="nav-link d-flex align-items-center" asp-area="" asp-page="/Public/Servicios">
                                <i class="bi bi-gear-fill me-2"></i> Servicios
                            </a>
                        </li>
                        <li class="nav-item nav-item-important">
                            <a class="nav-link d-flex align-items-center" asp-area="" asp-page="/Public/About">
                                <i class="bi bi-building me-2"></i> Sobre Nosotros
                            </a>
                        </li>
                        <li class="nav-item nav-item-important">
                            <a class="nav-link d-flex align-items-center" asp-area="" asp-page="/Public/Team">
                                <i class="bi bi-people-fill me-2"></i> Equipo
                            </a>
                        </li>
                        <li class="nav-item nav-item-important">
                            <a class="nav-link d-flex align-items-center" asp-area="" asp-page="/Public/Contact">
                                <i class="bi bi-envelope-fill me-2"></i> Contacto
                            </a>
                        </li>
                        <li class="nav-item nav-item-important">
                            <a class="nav-link d-flex align-items-center" asp-area="" asp-page="/Public/Support">
                                <i class="bi bi-headset me-2"></i> Soporte T√©cnico
                            </a>
                        </li>
                        <li class="nav-item nav-item-important">
                            <a class="nav-link d-flex align-items-center" asp-area="" asp-page="/Public/FAQ">
                                <i class="bi bi-question-circle-fill me-2"></i> FAQ
                            </a>
                        </li>
                    }
                </ul>

                @* LADO DERECHO *@
                <div class="d-flex align-items-center">
                    @if (SignInManager.IsSignedIn(User))
                    {
                        @* TEMA PARA USUARIOS LOGUEADOS *@
                        <button class="btn btn-medical me-3 d-none d-xl-flex" type="button" id="themeToggleBtn" title="Cambiar tema">
                            <i class="bi bi-sun-fill" id="themeIconSun"></i>
                            <i class="bi bi-moon-stars-fill" id="themeIconMoon" style="display:none;"></i>
                        </button>
                    }
                    else
                    {
                        @* TEMA PARA USUARIOS NO LOGUEADOS - DESKTOP *@
                        <button class="btn btn-theme-toggle me-3 d-none d-xl-flex align-items-center" type="button" id="themeToggleBtnGuest" title="Cambiar tema">
                            <i class="bi bi-sun-fill" id="themeIconSunGuest"></i>
                            <i class="bi bi-moon-stars-fill" id="themeIconMoonGuest" style="display:none;"></i>
                        </button>
                    }

                    @if (SignInManager.IsSignedIn(User))
                    {
                        var currentUser = await UserManager.GetUserAsync(User);
                        var displayName = currentUser?.FirstName + " " + currentUser?.LastName;
                        if (string.IsNullOrWhiteSpace(displayName?.Trim()))
                        {
                            displayName = UserManager.GetUserName(User);
                        }

                        @* NOTIFICACIONES *@
                        <div class="dropdown me-3">
                            <button class="btn btn-medical position-relative" type="button" id="notificationDropdown" data-bs-toggle="dropdown" style="width: 60px; height: 42px; display: flex; align-items: center; justify-content: center; overflow: visible;">
                                <i class="bi bi-bell-fill" style="font-size: 1rem; line-height: 1;"></i>
                                <span class="position-absolute badge rounded-pill bg-danger" id="notificationBadge" style="display: none; min-width: 22px; height: 22px; line-height: 22px; font-size: 0.75rem; padding: 0; top: -5px; right: -8px; font-weight: 700; border: 2px solid white; box-shadow: 0 2px 8px rgba(0,0,0,0.3);">1</span>
                            </button>
                            <div class="dropdown-menu dropdown-menu-end notification-panel" style="width: 350px; max-width: 90vw; padding: 0;">
                                <!-- Header siempre visible -->
                                <div class="notification-header">
                                    <h6 class="dropdown-header">Notificaciones</h6>
                                </div>
                                
                                <!-- Contenedor con scroll para las notificaciones -->
                                <div class="notification-content" style="max-height: 300px; overflow-y: auto;">
                                    <hr class="dropdown-divider" id="notificationItemsDivider" style="margin: 0;">
                                    <div id="notificationItemsList" style="display: none;"></div>
                                    <div class="text-center p-3 text-muted" id="noNotificationsMessageDisplay">Sin notificaciones</div>
                                </div>
                                
                                <!-- Footer siempre visible -->
                                <div class="notification-footer" style="border-top: 1px solid rgba(0,0,0,0.1); background: rgba(248,249,250,0.95); display: none;" id="notificationFooter">
                                    <a class="dropdown-item text-center text-primary" href="#" id="markAllAsReadLink" style="font-size: 0.875rem; font-weight: 600; padding: 0.75rem;">
                                        <i class="bi bi-check2-all me-2"></i>Marcar todas como le√≠das
                                    </a>
                                </div>
                            </div>
                        </div>

                        @* USUARIO *@
                        <div class="dropdown">
                            <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown">
                                <i class="bi bi-person-circle me-2"></i> 
                                <span class="d-none d-md-inline">@displayName</span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item d-flex align-items-center" asp-area="Identity" asp-page="/Account/Manage/Index">
                                    <i class="bi bi-gear me-2"></i> Mi Cuenta
                                </a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li>
                                    <form asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Page("/Index", new { area = "" })">
                                        <button type="submit" class="dropdown-item d-flex align-items-center">
                                            <i class="bi bi-box-arrow-right me-2"></i> Cerrar Sesi√≥n
                                        </button>
                                    </form>
                                </li>
                            </ul>
                        </div>
                    }
                    else
                    {
                        @* NO LOGUEADOS - BOTONES *@
                        <div class="d-flex gap-2 justify-content-center align-items-center">
                            <a class="btn btn-register d-flex align-items-center justify-content-center" asp-area="Identity" asp-page="/Account/Register">
                                <i class="bi bi-person-plus me-2"></i> 
                                <span class="d-none d-sm-inline">Registrarse</span>
                            </a>
                            <a class="btn btn-login d-flex align-items-center justify-content-center" asp-area="Identity" asp-page="/Account/Login">
                                <i class="bi bi-box-arrow-in-right me-2"></i> 
                                <span class="d-none d-sm-inline">Iniciar Sesi√≥n</span>
                            </a>
                        </div>
                    }
                </div>
                

            </div>
        </div>
    </nav>
</header>

@* MEN√ö M√ìVIL Y DE ESCRITORIO REFINADO *@
<style>
    /* === PREVENIR FLASH/REBOTE VISUAL SOLO DURANTE CARGA INICIAL === */
    .preload *, 
    .preload ::before, 
    .preload ::after,
    .navbar-preload *,
    .navbar-preload ::before,
    .navbar-preload ::after {
        transition: none !important;
        animation: none !important;
        transform: none !important;
    }
    
    /* Permitir animaciones inmediatamente despu√©s de quitar preload */
    .navbar:not(.navbar-preload) {
        animation-delay: 0s !important;
    }
    
    /* Fijar dimensiones cr√≠ticas durante la carga para evitar reajustes */
    .navbar-preload {
        min-height: 70px !important; /* Altura fija para evitar saltos */
    }
    
    .navbar-preload .navbar-brand {
        font-size: 1.3rem !important;
        font-weight: 700 !important;
        line-height: 1.2 !important;
        height: auto !important;
        min-height: 40px !important;
    }
    
    .navbar-preload .navbar-nav .nav-link {
        font-size: 0.825rem !important;
        padding: 0.4rem 0.6rem !important;
        line-height: 1.4 !important;
        min-height: 35px !important;
        display: flex !important;
        align-items: center !important;
    }
    
    .navbar-preload .navbar-nav .nav-link i {
        font-size: 0.8rem !important;
        margin-right: 0.3rem !important;
        width: 0.8rem !important;
        text-align: center !important;
    }
    
    .navbar-preload .btn {
        font-size: inherit !important;
        padding: 0.375rem 0.75rem !important;
        line-height: 1.5 !important;
        min-height: 38px !important;
    }
    
    /* === ANIMACIONES HABILITADAS SIEMPRE (MEJORADO) === */
    .navbar {
        /* Navbar principal */
        transition: box-shadow 0.3s ease-in-out, background-color 0.3s ease !important;
        overflow: visible !important;
    }
    
    /* Asegurar que todos los contenedores permitan el efecto shimmer */
    .navbar .container-fluid,
    .navbar .d-flex,
    .navbar .gap-2,
    .navbar .align-items-center {
        overflow: visible !important;
    }
    
    .navbar .nav-link {
        /* Links de navegaci√≥n */
        transition: all 0.3s ease, background-color 0.15s ease, color 0.15s ease, transform 0.2s ease !important;
    }
    
    .navbar .nav-link:hover {
        transform: translateY(-1px) !important;
        background-color: rgba(255,255,255,0.1) !important;
    }
    
    .navbar .btn {
        /* Botones del navbar */
        transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) !important;
        position: relative !important;
        border-radius: 8px !important;
        overflow: hidden !important;
    }
    
    /* Efecto shimmer solo para botones que no son de notificaciones */
    .navbar .btn:not(#notificationDropdown)::before {
        content: '' !important;
        position: absolute !important;
        top: 0 !important;
        left: -100% !important;
        width: 100% !important;
        height: 100% !important;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent) !important;
        transition: left 0.6s ease !important;
        z-index: 1 !important;
        transform: translateZ(0) !important;
    }
    
    .navbar .btn:not(#notificationDropdown):hover::before {
        left: 100% !important;
    }
    
    /* Bot√≥n de notificaciones sin efecto shimmer */
    #notificationDropdown {
        overflow: visible !important;
    }
    
    #notificationDropdown::before {
        display: none !important;
    }
    
    .navbar .btn:hover {
        transform: translateY(-2px) !important;
        box-shadow: 0 8px 20px rgba(0,0,0,0.15) !important;
    }
    

    
    .navbar .btn span,
    .navbar .btn i {
        position: relative !important;
        z-index: 3 !important;
    }
    
    /* Navbar hover effect */
    .navbar:hover {
        box-shadow: 0 .5rem 1rem rgba(0,0,0,.175) !important;
    }
    
    /* Dropdown menu animations */
    .navbar .dropdown-menu {
        animation: dropdownFadeIn 0.2s ease !important;
        transition: all 0.2s ease !important;
    }
    
    @@keyframes dropdownFadeIn {
        from { 
            opacity: 0; 
            transform: translateY(-10px); 
        }
        to { 
            opacity: 1; 
            transform: translateY(0); 
        }
    }
    

    
    /* === ESTILOS BASE CR√çTICOS PARA EVITAR FLASH === */
    
    /* LOGO/BRAND - DIMENSIONES FIJAS PARA EVITAR REBOTE + ANIMACIONES */
    .navbar-brand {
        font-size: 1.3rem !important;
        font-weight: 700 !important;
        line-height: 1.2 !important;
        height: auto !important;
        min-height: 40px !important;
        padding: 0.3125rem 0 !important; /* Padding vertical est√°ndar */
        color: var(--bs-navbar-brand-color) !important;
        text-decoration: none !important;
        white-space: nowrap !important;
        display: flex !important;
        align-items: center !important;
        transition: all 0.3s ease !important;
    }
    
    .navbar-brand:hover,
    .navbar-brand:focus {
        color: var(--bs-navbar-brand-hover-color) !important;
        text-decoration: none !important;
        transform: scale(1.05) !important;
    }
    
    /* Animaci√≥n del icono de coraz√≥n */
    .navbar-brand .brand-icon {
        transition: all 0.3s ease !important;
    }
    
    .navbar-brand:hover .brand-icon {
        animation: heartbeat 1s ease-in-out !important;
        color: #dc3545 !important;
        filter: drop-shadow(0 0 8px rgba(220, 53, 69, 0.5)) !important;
    }
    
    @@keyframes heartbeat {
        0%, 100% { transform: scale(1); }
        25% { transform: scale(1.1); }
        50% { transform: scale(1.2); }
        75% { transform: scale(1.1); }
    }
    
    /* Asegurar que el logo mantiene tama√±o en modo oscuro */
    [data-bs-theme="dark"] .navbar-brand {
        font-size: 1.3rem !important;
        font-weight: 700 !important;
        line-height: 1.2 !important;
    }
    
    /* Logo siempre blanco en panel del doctor - FORZADO */
    body.doctor-body-bg .navbar-brand,
    body.doctor-body-bg .navbar-brand .brand-text,
    body.doctor-body-bg .navbar-brand span {
        color: white !important;
    }
    
    body.doctor-body-bg .navbar-brand .brand-text .text-info,
    body.doctor-body-bg .navbar-brand .text-info {
        color: rgba(255, 255, 255, 0.8) !important;
    }
    
    /* Logo tambi√©n blanco en paneles de admin y paciente - FORZADO */
    body.admin-body-bg .navbar-brand,
    body.admin-body-bg .navbar-brand .brand-text,
    body.admin-body-bg .navbar-brand span,
    body.patient-body-bg .navbar-brand,
    body.patient-body-bg .navbar-brand .brand-text,
    body.patient-body-bg .navbar-brand span {
        color: white !important;
    }
    
    body.admin-body-bg .navbar-brand .brand-text .text-info,
    body.admin-body-bg .navbar-brand .text-info,
    body.patient-body-bg .navbar-brand .brand-text .text-info,
    body.patient-body-bg .navbar-brand .text-info {
        color: rgba(255, 255, 255, 0.8) !important;
    }
    
    /* Clase espec√≠fica para "Care" - M√ÅXIMA PRIORIDAD */
    body.doctor-body-bg .brand-care-text,
    body.admin-body-bg .brand-care-text,
    body.patient-body-bg .brand-care-text {
        color: rgba(255, 255, 255, 0.8) !important;
    }
    
    /* OVERRIDE COMPLETO para logo blanco - DEBE SER LO √öLTIMO */
    .doctor-body-bg .navbar-brand,
    .admin-body-bg .navbar-brand,
    .patient-body-bg .navbar-brand {
        color: white !important;
    }
    
    .doctor-body-bg .navbar-brand *,
    .admin-body-bg .navbar-brand *,
    .patient-body-bg .navbar-brand * {
        color: inherit !important;
    }
    
    .doctor-body-bg .navbar-brand .brand-care-text,
    .admin-body-bg .navbar-brand .brand-care-text,
    .patient-body-bg .navbar-brand .brand-care-text {
        color: rgba(255, 255, 255, 0.8) !important;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Forzar el color blanco del logo en paneles espec√≠ficos
        function forceLogoWhite() {
            const body = document.body;
            const brandText = document.querySelector('.navbar-brand .brand-text');
            const careText = document.querySelector('.navbar-brand .brand-care-text');
            
            if (body.classList.contains('doctor-body-bg') || 
                body.classList.contains('admin-body-bg') || 
                body.classList.contains('patient-body-bg')) {
                
                if (brandText) {
                    brandText.style.color = 'white';
                    brandText.style.setProperty('color', 'white', 'important');
                }
                
                if (careText) {
                    careText.style.color = 'rgba(255, 255, 255, 0.8)';
                    careText.style.setProperty('color', 'rgba(255, 255, 255, 0.8)', 'important');
                }
            }
        }
        
        // Aplicar inmediatamente
        forceLogoWhite();
        
        // Aplicar despu√©s de un breve delay para asegurar que otros CSS han cargado
        setTimeout(forceLogoWhite, 100);
        setTimeout(forceLogoWhite, 500);
    });
</script>

<style>    
    /* Aplicar estilos base inmediatamente para evitar que Bootswatch cause reajustes */
    .navbar-expand-xl .navbar-nav .nav-item .nav-link {
        padding: 0.4rem 0.6rem !important;
        margin: 0 0.05rem !important;
        font-size: 0.825rem !important;
        background: transparent !important;
        border-radius: 0.25rem !important;
        line-height: 1.4 !important;
        white-space: nowrap !important;
        display: flex !important; 
        align-items: center !important;
    }
    
    .navbar-expand-xl .navbar-nav .nav-item .nav-link i {
        font-size: 0.8rem !important;
        margin-right: 0.3rem !important;
        margin-bottom: 0 !important;
        line-height: 1 !important;
        transition: all 0.3s ease !important;
    }
    
    /* Animaciones de iconos en hover */
    .navbar .nav-link:hover i {
        transform: scale(1.1) rotate(5deg) !important;
        color: #007bff !important;
    }
    
    /* Animaciones espec√≠ficas para diferentes iconos */
    .navbar .nav-link:hover .bi-house-door-fill {
        animation: bounceIcon 0.6s ease !important;
    }
    
    .navbar .nav-link:hover .bi-calendar-plus-fill,
    .navbar .nav-link:hover .bi-calendar-event-fill,
    .navbar .nav-link:hover .bi-calendar-week-fill {
        animation: pulseIcon 0.6s ease !important;
    }
    
    .navbar .nav-link:hover .bi-person-badge-fill,
    .navbar .nav-link:hover .bi-person-lines-fill,
    .navbar .nav-link:hover .bi-person-gear {
        animation: wiggleIcon 0.6s ease !important;
    }
    
    @@keyframes bounceIcon {
        0%, 100% { transform: scale(1.1) translateY(0); }
        50% { transform: scale(1.2) translateY(-3px); }
    }
    
    @@keyframes pulseIcon {
        0%, 100% { transform: scale(1.1); }
        50% { transform: scale(1.3); }
    }
    
    @@keyframes wiggleIcon {
        0%, 100% { transform: scale(1.1) rotate(5deg); }
        25% { transform: scale(1.2) rotate(-5deg); }
        75% { transform: scale(1.2) rotate(10deg); }
    }

    /* === ESTILOS PARA NOTIFICACIONES === */
    .notification-panel {
        border: none !important;
        box-shadow: 0 .5rem 1rem rgba(0,0,0,.15) !important;
        border-radius: 0.5rem !important;
        overflow: hidden !important;
    }

    .notification-header {
        background: rgba(0, 123, 255, 0.05) !important;
        border-bottom: 1px solid rgba(0,0,0,0.1) !important;
        margin: 0 !important;
    }

    .notification-header .dropdown-header {
        font-weight: 600 !important;
        color: #007bff !important;
        margin: 0 !important;
        padding: 1rem !important;
    }

    .notification-content {
        max-height: 300px !important;
        overflow-y: auto !important;
        overflow-x: hidden !important;
    }

    .notification-content::-webkit-scrollbar {
        width: 4px;
    }

    .notification-content::-webkit-scrollbar-track {
        background: rgba(0,0,0,0.05);
    }

    .notification-content::-webkit-scrollbar-thumb {
        background: rgba(0,0,0,0.3);
        border-radius: 2px;
    }

    .notification-content::-webkit-scrollbar-thumb:hover {
        background: rgba(0,0,0,0.5);
    }

    .notification-footer {
        position: sticky !important;
        bottom: 0 !important;
        background: rgba(248,249,250,0.95) !important;
        backdrop-filter: blur(10px) !important;
        border-top: 1px solid rgba(0,0,0,0.1) !important;
        margin: 0 !important;
        z-index: 10 !important;
    }

    .notification-footer:hover {
        background: rgba(248,249,250,1) !important;
    }

    .notification-item {
        border-bottom: 1px solid rgba(0,0,0,0.1);
        transition: background-color 0.2s ease;
        list-style: none !important;
        margin: 0 !important;
        padding: 0 !important;
    }

    .notification-item:last-child {
        border-bottom: none;
    }

    .notification-item.notification-unread {
        background-color: rgba(0, 123, 255, 0.05);
        border-left: 3px solid #007bff;
    }

    .notification-item.notification-read {
        background-color: transparent;
        opacity: 0.7;
    }

    .notification-item:hover {
        background-color: rgba(0, 123, 255, 0.1) !important;
    }

    .notification-item .dropdown-item {
        white-space: normal !important;
        padding: 0.75rem 1rem !important;
        word-wrap: break-word !important;
        overflow-wrap: break-word !important;
        min-height: auto !important;
        border: none !important;
        border-radius: 0 !important;
    }

    .notification-item .dropdown-item p {
        margin-bottom: 0.25rem !important;
        font-size: 0.875rem !important;
        line-height: 1.4 !important;
        white-space: normal !important;
        word-wrap: break-word !important;
        overflow-wrap: break-word !important;
    }

    .notification-item .dropdown-item small {
        font-size: 0.75rem !important;
        opacity: 0.8 !important;
        white-space: normal !important;
    }

    #notificationBadge {
        font-size: 0.75rem !important;
        min-width: 22px !important;
        height: 22px !important;
        line-height: 22px !important;
        text-align: center !important;
        padding: 0 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        font-weight: 700 !important;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3) !important;
        border: 2px solid white !important;
        position: absolute !important;
        top: -5px !important;
        right: -8px !important;
        z-index: 10 !important;
    }
    
    /* Asegurar que el contenedor del bot√≥n de notificaciones no corte el badge */
    .dropdown .btn-medical {
        overflow: visible !important;
        position: relative !important;
    }

    /* === ESTILOS PARA MODO OSCURO === */
    [data-bs-theme="dark"] .notification-header {
        background: rgba(55, 65, 81, 0.8) !important;
        border-bottom: 1px solid rgba(255,255,255,0.1) !important;
    }

    [data-bs-theme="dark"] .notification-header .dropdown-header {
        color: #60a5fa !important;
    }

    [data-bs-theme="dark"] .notification-footer {
        background: rgba(31, 41, 55, 0.95) !important;
        border-top: 1px solid rgba(255,255,255,0.1) !important;
    }

    [data-bs-theme="dark"] .notification-footer:hover {
        background: rgba(31, 41, 55, 1) !important;
    }

    [data-bs-theme="dark"] .notification-item.notification-unread {
        background-color: rgba(59, 130, 246, 0.1);
        border-left: 3px solid #60a5fa;
    }

    [data-bs-theme="dark"] .notification-item:hover {
        background-color: rgba(59, 130, 246, 0.2) !important;
    }

    [data-bs-theme="dark"] .notification-content::-webkit-scrollbar-track {
        background: rgba(255,255,255,0.05);
    }

    [data-bs-theme="dark"] .notification-content::-webkit-scrollbar-thumb {
        background: rgba(255,255,255,0.3);
    }

    [data-bs-theme="dark"] .notification-content::-webkit-scrollbar-thumb:hover {
        background: rgba(255,255,255,0.5);
    }
    
    /* === ANIMACIONES DE HAMBURGUESA PERSONALIZADAS === */
    .navbar-toggler {
        border: none !important;
        padding: 0.5rem;
        width: 50px;
        height: 50px;
        position: relative;
        background: transparent !important;
        border-radius: 8px !important;
        transition: all 0.3s ease;
        cursor: pointer;
    }
    
    .navbar-toggler:focus {
        box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25) !important;
    }
    
    .navbar-toggler:hover {
        transform: scale(1.05);
        background: rgba(0, 123, 255, 0.1) !important;
    }
    
    .navbar-toggler-icon {
        background: none !important;
        width: 100% !important;
        height: 100% !important;
        position: relative;
        display: flex !important;
        align-items: center;
        justify-content: center;
    }
    
    .hamburger-lines {
        width: 25px;
        height: 20px;
        position: relative;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }
    
    .hamburger-lines .line {
        width: 100%;
        height: 3px;
        background-color: currentColor;
        border-radius: 2px;
        transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        transform-origin: center;
    }
    
    /* Animaci√≥n cuando est√° activo (abierto) */
    .navbar-toggler.active {
        transform: rotate(180deg);
    }
    
    .navbar-toggler.active .line1 {
        transform: translateY(8.5px) rotate(45deg);
    }
    
    .navbar-toggler.active .line2 {
        opacity: 0;
        transform: scaleX(0);
    }
    
    .navbar-toggler.active .line3 {
        transform: translateY(-8.5px) rotate(-45deg);
    }
    
    /* Hover effects */
    .navbar-toggler:hover .line {
        background-color: #007bff;
        transform: scaleX(1.1);
    }
    
    /* Animaci√≥n de pulso para el bot√≥n hamburguesa */
    @@keyframes hamburgerPulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }
    
    .navbar-toggler:focus {
        animation: hamburgerPulse 0.6s ease;
    }
    
    /* === ESTILOS CONSOLIDADOS PARA BOTONES - EVITAR REBOTE === */
    
    /* === ESTILOS DE BOTONES MOVIDOS A _LAYOUT.CSHTML === */
    /* Los estilos de .btn-login y .btn-register est√°n ahora en _Layout.cshtml
       con CSS cr√≠tico inline para evitar conflictos y rebote visual durante la carga */
    
    /* Responsive - Ocultar iconos en m√≥vil, mantener dimensiones */
    @@media (max-width: 1199.98px) {
        .navbar .btn-login i, 
        .navbar .btn-register i {
            display: none !important;
        }
        
        .navbar .btn-login span, 
        .navbar .btn-register span {
            font-size: 0.85rem !important;
        }
        
        .navbar .btn-login,
        .navbar .btn-register {
            padding: 0.4rem 0.8rem !important;
            min-height: 36px !important;
        }
    }
    
    /* Mostrar iconos en desktop */
    @@media (min-width: 1200px) {
        .navbar .btn-login i, 
        .navbar .btn-register i {
            display: inline-block !important;
        }
    }

    /* Base para Toggler y Collapse */
    .navbar-expand-xl .navbar-toggler { display: block; }
    .navbar-expand-xl .navbar-collapse { display: none; }
    .navbar-expand-xl .navbar-collapse.show { display: block !important; }

    /* --- VISTA DE ESCRITORIO (min-width: 1200px) --- */
    @@media (min-width: 1200px) {
        .navbar-expand-xl .navbar-toggler { display: none !important; }
        .navbar-expand-xl .navbar-collapse { display: flex !important; flex-basis: auto; align-items: center; }
        .navbar-expand-xl .navbar-nav { flex-direction: row; align-items: center; }

        .navbar-expand-xl .navbar-nav .nav-item .nav-link {
            padding: 0.4rem 0.6rem !important;
            margin: 0 0.05rem !important;
            font-size: 0.825rem !important;
            background: transparent !important;
            border-radius: var(--bs-border-radius-sm, 0.25rem);
            transition: background-color 0.15s ease, color 0.15s ease;
            line-height: 1.4;
            white-space: nowrap;
            display: flex; align-items: center;
        }
        .navbar-expand-xl .navbar-nav .nav-item .nav-link i {
            font-size: 0.8rem !important;
            margin-right: 0.3rem !important;
            margin-bottom: 0 !important;
            line-height: 1;
        }
        .navbar-expand-xl .navbar-nav .nav-item .nav-link:hover {
            background-color: rgba(var(--bs-emphasis-color-rgb), 0.15);
            color: var(--bs-emphasis-color);
        }
        body.doctor-body-bg .navbar-expand-xl .navbar-nav .nav-item.nav-item-important .nav-link,
        body.patient-body-bg .navbar-expand-xl .navbar-nav .nav-item.nav-item-important .nav-link,
        body.admin-body-bg .navbar-expand-xl .navbar-nav .nav-item.nav-item-important .nav-link {
            background: rgba(255,255,255,0.12) !important;
            color: rgba(255,255,255,0.9) !important;
        }
        body.doctor-body-bg .navbar-expand-xl .navbar-nav .nav-item.nav-item-important .nav-link:hover,
        body.patient-body-bg .navbar-expand-xl .navbar-nav .nav-item.nav-item-important .nav-link:hover,
        body.admin-body-bg .navbar-expand-xl .navbar-nav .nav-item.nav-item-important .nav-link:hover {
            background: rgba(255,255,255,0.25) !important;
            color: #fff !important;
        }

        /* Espaciado aumentado para navbars de doctor y paciente espec√≠ficamente */
        body.doctor-body-bg .navbar-expand-xl .navbar-nav .nav-item .nav-link,
        body.patient-body-bg .navbar-expand-xl .navbar-nav .nav-item .nav-link {
            margin: 0 0.25rem !important; /* Aumentar margen horizontal */
            padding: 0.5rem 0.8rem !important; /* Aumentar padding */
        }
    }

    /* --- MEN√ö HAMBURGUESA CON ANIMACIONES Y COLUMNAS (max-width: 1199.98px) --- */
    @@media (max-width: 1199.98px) {
        .navbar-collapse {
            background: var(--bs-body-bg) !important;
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 0.75rem;
            margin-left: 1rem;
            margin-right: 1rem;
            box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.15);
            border: 1px solid var(--bs-border-color);
            position: relative !important;
            z-index: 1050;
            
            /* ANIMACIONES MEJORADAS DE ENTRADA Y SALIDA */
            opacity: 0;
            transform: translateY(-15px) scale(0.98);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: none;
            max-height: 0;
            overflow: hidden;
        }
        
        .navbar-collapse.show {
            opacity: 1 !important;
            transform: translateY(0) scale(1) !important;
            pointer-events: auto !important;
            max-height: 100vh !important;
            overflow: visible !important;
        }
        
        /* Animaci√≥n de salida cuando se cierra - M√ÅS SUAVE */
        .navbar-collapse.collapsing {
            opacity: 0 !important;
            transform: translateY(-8px) scale(0.99) !important;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.6, 1) !important;
            max-height: 0 !important;
            overflow: hidden !important;
        }
        
        body.doctor-body-bg .navbar-collapse,
        body.patient-body-bg .navbar-collapse,
        body.admin-body-bg .navbar-collapse {
            background: var(--bs-dark) !important; 
            border-color: rgba(255,255,255,0.1);
            box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.3);
        }

        /* LAYOUT EN COLUMNAS RESPONSIVO */
        .navbar-nav {
            display: grid !important;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)) !important; /* Columnas adaptables */
            gap: 0.5rem !important;
            width: 100%;
            margin-bottom: 1rem !important;
        }

        .nav-item {
            width: 100% !important;
        }

        .nav-item .nav-link {
            padding: 0.7rem 0.5rem !important;
            border-radius: 0.375rem;
            background: var(--bs-secondary-bg-subtle) !important;
            text-align: center !important; /* Centrado para layout en columnas */
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            font-weight: 500 !important;
            font-size: 0.85rem !important;
            color: var(--bs-emphasis-color) !important;
            border: 1px solid var(--bs-border-color-translucent);
            transition: all 0.2s ease;
            text-decoration: none !important;
            min-height: 50px; /* Altura m√≠nima uniforme */
        }
        
        /* MODO CLARO - Bordes visibles en nav-links */
        :root .nav-item .nav-link,
        [data-bs-theme="light"] .nav-item .nav-link {
            border: 2px solid #dee2e6 !important;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1) !important;
        }
        
        /* MANTENER ICONOS VISIBLES EN ESCRITORIO, OCULTOS EN M√ìVIL */
        .nav-item .nav-link i {
            display: inline-block !important; /* Mostrar iconos en m√≥vil tambi√©n */
            margin-right: 0.5rem !important;
            font-size: 0.9rem !important;
        }
        
        /* Hover para nav-links */
        .nav-item .nav-link:hover, .nav-item .nav-link:focus {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%) !important;
            color: white !important;
            border-color: #334155 !important;
            transform: translateY(-2px) !important; /* Efecto de elevaci√≥n */
            box-shadow: 0 4px 8px rgba(30, 41, 59, 0.3);
        }
        
        /* MODO CLARO - Hover con texto oscuro visible */
        :root .nav-item .nav-link:hover,
        :root .nav-item .nav-link:focus,
        [data-bs-theme="light"] .nav-item .nav-link:hover,
        [data-bs-theme="light"] .nav-item .nav-link:focus {
            background: #e9ecef !important;
            color: #0f172a !important;
            border-color: #adb5bd !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
        }

        /* Estilos espec√≠ficos para roles */
        body.patient-body-bg .navbar-collapse .nav-link {
            background: rgba(34, 197, 94, 0.1) !important;
            border-color: rgba(34, 197, 94, 0.2);
            color: var(--bs-light) !important;
        }
        body.patient-body-bg .navbar-collapse .nav-link:hover {
            background: linear-gradient(135deg, #059669 0%, #10b981 100%) !important;
            border-color: #10b981 !important;
            color: white !important;
        }

        body.doctor-body-bg .navbar-collapse .nav-link,
        body.admin-body-bg .navbar-collapse .nav-link {
            background: rgba(255, 255, 255, 0.15) !important;
            border-color: rgba(255,255,255,0.3);
            color: var(--bs-light) !important;
        }
        body.doctor-body-bg .navbar-collapse .nav-link:hover,
        body.admin-body-bg .navbar-collapse .nav-link:hover {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%) !important;
            border-color: #334155 !important;
            color: white !important;
        }

        /* Botones inferiores - MEJORADOS PARA UNA SOLA L√çNEA */
        .navbar-collapse > .d-flex.align-items-center {
            display: flex !important;
            flex-direction: row !important; /* Forzar fila */
            justify-content: space-between !important;
            align-items: center !important;
            gap: 0.5rem !important;
            margin-top: 1rem !important;
            padding-top: 1rem !important;
            border-top: 1px solid var(--bs-border-color) !important;
            flex-wrap: nowrap !important; /* Evitar wrapping */
        }
        
        /* Contenedor de botones m√≥viles - UNA SOLA L√çNEA */
        .mobile-buttons-container {
            display: flex !important;
            flex-direction: row !important;
            gap: 0.5rem !important;
            align-items: center !important;
            flex: 1 !important;
            min-width: 0 !important; /* Permitir shrinking */
        }
        
        body.doctor-body-bg .navbar-collapse > .d-flex.align-items-center,
        body.patient-body-bg .navbar-collapse > .d-flex.align-items-center,
        body.admin-body-bg .navbar-collapse > .d-flex.align-items-center {
            border-top-color: rgba(255,255,255,0.3) !important;
        }
        
        .navbar-collapse > .d-flex.align-items-center .btn,
        .navbar-collapse > .d-flex.align-items-center .nav-link,
        .mobile-buttons-container .btn {
            font-size: 0.75rem !important; /* Tama√±o m√°s peque√±o */
            padding: 0.4rem 0.6rem !important; /* Padding reducido */
            flex: 1 !important; /* Distribuci√≥n equitativa */
            text-align: center !important;
            border-radius: 0.375rem !important;
            white-space: nowrap !important; /* Evitar texto en m√∫ltiples l√≠neas */
            min-width: 0 !important; /* Permitir shrinking */
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            gap: 0.3rem !important; /* Espacio entre icono y texto */
        }
        
        /* Bot√≥n de tema - tama√±o espec√≠fico - SOLO PARA DESKTOP */
        .navbar-collapse > .d-flex.align-items-center #themeToggleBtn {
            flex: 0 0 auto !important;
            width: 40px !important;
            height: 40px !important;
            padding: 0.5rem !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            gap: 0 !important; /* Sin gap para bot√≥n de tema */
        }
        
        /* OCULTAR cualquier bot√≥n de tema en m√≥vil dentro del collapse */
        @@media (max-width: 1199.98px) {
            .navbar-collapse #themeToggleBtn {
                display: none !important;
            }
            
            /* OCULTAR TODOS los botones de tema dentro del collapse m√≥vil */
            .navbar-collapse .btn-theme-toggle {
                display: none !important;
            }
            
            /* OCULTAR cualquier elemento con iconos de tema dentro del collapse */
            .navbar-collapse .bi-sun-fill,
            .navbar-collapse .bi-moon-stars-fill {
                display: none !important;
            }
        }
        
        /* MOSTRAR iconos y texto en botones m√≥viles */
        .navbar-collapse > .d-flex.align-items-center .btn i,
        .mobile-buttons-container .btn i {
            display: inline-block !important;
            font-size: 0.8rem !important;
        }
        
        .navbar-collapse > .d-flex.align-items-center .btn span,
        .mobile-buttons-container .btn span {
            display: inline-block !important;
            font-size: 0.7rem !important;
        }
        
        /* Mostrar iconos en desktop */
        @@media (min-width: 1200px) {
            .navbar-collapse > .d-flex.align-items-center .btn i,
            .navbar-collapse > .d-flex.align-items-center .nav-link i {
                display: inline-block !important;
            }
        }
    }

    /* TABLETS Y PANTALLAS MEDIANAS - 2-3 columnas */
    @@media (max-width: 1199.98px) and (min-width: 600px) {
        .navbar-nav {
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)) !important;
        }
    }

    /* PANTALLAS PEQUE√ëAS - 2 columnas */
    @@media (max-width: 599.98px) and (min-width: 400px) {
        .navbar-nav {
            grid-template-columns: repeat(2, 1fr) !important;
            gap: 0.4rem !important;
        }
        .nav-item .nav-link {
            font-size: 0.8rem !important;
            padding: 0.6rem 0.4rem !important;
            min-height: 45px !important;
        }
        .navbar-collapse {
            margin-left: 0.5rem !important;
            margin-right: 0.5rem !important;
            padding: 0.75rem !important;
        }
        
        /* Botones a√∫n m√°s peque√±os en pantallas peque√±as */
        .mobile-buttons-container .btn {
            font-size: 0.65rem !important;
            padding: 0.3rem 0.4rem !important;
        }
        
        .mobile-buttons-container .btn i {
            font-size: 0.7rem !important;
        }
        
        .mobile-buttons-container .btn span {
            font-size: 0.6rem !important;
        }
    }

    /* M√ìVILES MUY ESTRECHOS - 1 columna */
    @@media (max-width: 399.98px) {
        .navbar-nav {
            grid-template-columns: 1fr !important; /* UNA SOLA COLUMNA */
            gap: 0.4rem !important;
        }
        .nav-item .nav-link {
            font-size: 0.85rem !important;
            padding: 0.6rem 1rem !important;
            min-height: 45px !important;
            text-align: left !important; /* Alineaci√≥n izquierda en m√≥vil */
        }
        .navbar-collapse {
            margin-left: 0.25rem !important;
            margin-right: 0.25rem !important;
            padding: 0.75rem !important;
        }
        
        /* MANTENER BOTONES EN L√çNEA INCLUSO EN M√ìVILES MUY PEQUE√ëOS */
        .navbar-collapse > .d-flex.align-items-center {
            flex-direction: row !important; /* Forzar fila siempre */
        }
        
        .mobile-buttons-container .btn {
            font-size: 0.6rem !important;
            padding: 0.3rem 0.3rem !important;
        }
        
        .mobile-buttons-container .btn i {
            font-size: 0.65rem !important;
        }
        
        .mobile-buttons-container .btn span {
            font-size: 0.55rem !important;
        }
    }
    
    /* === MEJORAS DE RESPONSIVIDAD === */
    
    /* Asegurar que el colapso funcione correctamente */
    @@media (min-width: 1200px) {
        .navbar-collapse {
            opacity: 1 !important;
            transform: none !important;
            pointer-events: auto !important;
            background: transparent !important;
            border: none !important;
            box-shadow: none !important;
            margin: 0 !important;
            padding: 0 !important;
            position: static !important;
        }
        
        .navbar-nav .nav-item .nav-link i {
            display: inline-block !important;
        }
        
        /* Ocultar hamburguesa animada en desktop */
        .navbar-toggler {
            display: none !important;
        }
    }
    
    /* Fix responsivity when resizing from mobile to desktop */
    .navbar-collapse.collapsing {
        height: auto !important;
    }
    
    /* === MEJORA ESPEC√çFICA PARA FAQ === */
    /* Asegurar que todos los elementos de navegaci√≥n tengan el mismo tratamiento responsive */
    @@media (max-width: 1199.98px) {
        .navbar-nav .nav-item:last-child .nav-link {
            /* FAQ y √∫ltimo elemento siempre visible en responsive */
            display: flex !important;
        }
        
        /* Asegurar que no se corte ning√∫n elemento del men√∫ */
        .navbar-nav {
            overflow: visible !important;
        }
        
        /* Grid espec√≠fico para asegurar que todos los items sean visibles */
        .navbar-nav {
            grid-auto-rows: auto !important;
            min-height: auto !important;
        }
    }
    
    :root {
        --patient-primary-rgb: 15, 74, 45;
        --patient-accent-rgb: 34, 197, 94;
    }

    /* === BOT√ìN DE TEMA M√ìVIL FUERA DEL COLLAPSE === */
    #themeToggleBtnMobile {
        width: 40px !important;
        height: 40px !important;
        padding: 0.5rem !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        border-radius: 0.375rem !important;
    }
    
    /* === FORZAR OCULTACI√ìN DE BOTONES DE TEMA EN COLLAPSE === */
    @@media (max-width: 1199.98px) {
        .navbar-collapse button[id*="theme"],
        .navbar-collapse .btn[id*="theme"],
        .navbar-collapse [class*="theme-toggle"] {
            display: none !important;
            visibility: hidden !important;
            opacity: 0 !important;
            position: absolute !important;
            left: -9999px !important;
        }
    }
    
    /* === ESTILOS PARA MEN√ö DESPLEGABLE "M√ÅS" === */
    .navbar-nav .dropdown-menu {
        border: 1px solid var(--bs-border-color);
        box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.15);
        border-radius: 0.5rem;
        padding: 0.5rem 0;
        margin-top: 0.25rem;
        min-width: 200px;
    }
    
    .navbar-nav .dropdown-item {
        padding: 0.5rem 1rem;
        font-size: 0.9rem;
        transition: background-color 0.15s ease;
    }
    
    .navbar-nav .dropdown-item:hover {
        background-color: var(--bs-secondary-bg);
        color: var(--bs-emphasis-color);
    }
    
    .navbar-nav .dropdown-item i {
        width: 1.2rem;
        text-align: center;
    }
    
    /* Estilos espec√≠ficos para temas de doctor */
    body.doctor-body-bg .navbar-nav .dropdown-menu {
        background-color: var(--bs-dark);
        border-color: rgba(255,255,255,0.2);
    }
    
    body.doctor-body-bg .navbar-nav .dropdown-item {
        color: var(--bs-light);
    }
    
    body.doctor-body-bg .navbar-nav .dropdown-item:hover {
        background-color: rgba(255,255,255,0.1);
        color: #fff;
    }

    /* === ESTILOS DEL LOGO SEG√öN TEMA === */
    
    /* Logo en modo claro - "Vital" gris claro */
    :root,
    [data-bs-theme="light"] {
        --logo-vital-color: #9ca3af; /* Gris claro */
        --logo-care-color: #6b7280; /* Gris medio */
    }
    
    /* Logo en modo oscuro - completamente blanco */
    [data-bs-theme="dark"] {
        --logo-vital-color: #ffffff; /* Blanco completo */
        --logo-care-color: #ffffff; /* Blanco completo */
    }
    
    /* Aplicar colores a las clases del logo */
    .brand-text-vital {
        color: var(--logo-vital-color) !important;
        transition: color 0.3s ease;
    }
    
    .brand-text-care {
        color: var(--logo-care-color) !important;
        transition: color 0.3s ease;
    }

    /* === CORRECCI√ìN DE COLUMNAS RESPONSIVE === */
    
    /* Asegurar que el grid funcione correctamente en tablets */
    @@media (max-width: 1199.98px) {
        .navbar-collapse {
            width: 100% !important;
            max-width: 100% !important;
        }
        
        .navbar-nav {
            width: 100% !important;
            display: grid !important;
            grid-template-columns: repeat(3, 1fr) !important;
            gap: 0.5rem !important;
            margin: 0 !important;
            padding: 1rem 0 !important;
        }
        
        .nav-item {
            width: 100% !important;
            margin: 0 !important;
        }
        
        .nav-item .nav-link {
            width: 100% !important;
            text-align: center !important;
            justify-content: center !important;
            padding: 0.75rem 0.5rem !important;
            border-radius: 0.375rem !important;
            background: rgba(255,255,255,0.05) !important;
            border: 1px solid rgba(255,255,255,0.1) !important;
        }
    }
    
    /* Tablets medianos - 2 columnas */
    @@media (max-width: 991.98px) and (min-width: 600px) {
        .navbar-nav {
            grid-template-columns: repeat(2, 1fr) !important;
            gap: 0.4rem !important;
        }
    }
    
    /* M√≥viles - 1 columna */
    @@media (max-width: 599.98px) {
        .navbar-nav {
            grid-template-columns: 1fr !important;
            gap: 0.3rem !important;
        }
        
        .nav-item .nav-link {
            padding: 0.6rem 1rem !important;
            text-align: left !important;
            justify-content: flex-start !important;
        }
    }

    /* === BOTONES DE AUTENTICACI√ìN MEJORADOS === */
    
    /* Estilos base para botones */
    .navbar .btn-login,
    .navbar .btn-register {
        height: 38px !important;
        min-width: 120px !important;
        padding: 0.375rem 0.75rem !important;
        border-radius: 8px !important;
        font-size: 0.875rem !important;
        font-weight: 500 !important;
        display: inline-flex !important;
        align-items: center !important;
        justify-content: center !important;
        text-decoration: none !important;
        transition: all 0.3s ease !important;
        white-space: nowrap !important;
        overflow: hidden !important;
        border: 1px solid transparent !important; /* Borde transparente por defecto */
    }
    
    /* Botones de login y registro - estilos originales */
    .navbar .btn-login {
        background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%) !important;
        color: white !important;
        border: 1px solid #334155 !important;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
    }
    
    .navbar .btn-login:hover {
        background: linear-gradient(135deg, #1e293b 0%, #334155 100%) !important;
        color: white !important;
        transform: translateY(-1px) !important;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
        border: 1px solid #475569 !important;
    }
    
    .navbar .btn-register {
        background: linear-gradient(135deg, #1e40af 0%, #1d4ed8 100%) !important;
        color: white !important;
        border: 1px solid #1e40af !important;
        box-shadow: 0 2px 4px rgba(30, 64, 175, 0.2) !important;
    }
    
    .navbar .btn-register:hover {
        background: linear-gradient(135deg, #1d4ed8 0%, #2563eb 100%) !important;
        color: white !important;
        transform: translateY(-1px) !important;
        box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3) !important;
        border: 1px solid #1e40af !important;
    }
    
    /* MODO OSCURO - Botones con estilos adaptados */
    [data-bs-theme="dark"] .navbar .btn-login {
        background: linear-gradient(135deg, #374151 0%, #4b5563 100%) !important;
        color: white !important;
        border: 1px solid #6b7280 !important;
    }
    
    [data-bs-theme="dark"] .navbar .btn-login:hover {
        background: linear-gradient(135deg, #4b5563 0%, #6b7280 100%) !important;
        color: white !important;
        transform: translateY(-1px) !important;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3) !important;
        border: 1px solid #9ca3af !important;
    }
    
    [data-bs-theme="dark"] .navbar .btn-register {
        background: linear-gradient(135deg, #1e40af 0%, #1d4ed8 100%) !important;
        color: white !important;
        border: 1px solid #3b82f6 !important;
    }
    
    [data-bs-theme="dark"] .navbar .btn-register:hover {
        background: linear-gradient(135deg, #1d4ed8 0%, #2563eb 100%) !important;
        color: white !important;
        transform: translateY(-1px) !important;
        box-shadow: 0 4px 12px rgba(30, 64, 175, 0.4) !important;
        border: 1px solid #60a5fa !important;
    }
    
    /* Iconos de botones */
    .navbar .btn-login i,
    .navbar .btn-register i {
        font-size: 0.875rem !important;
        margin-right: 0.5rem !important;
        flex-shrink: 0 !important;
    }
    
    /* Asegurar color blanco del texto en todos los estados */
    .navbar .btn-login,
    .navbar .btn-login:hover,
    .navbar .btn-login:focus,
    .navbar .btn-login:active,
    .navbar .btn-register,
    .navbar .btn-register:hover,
    .navbar .btn-register:focus,
    .navbar .btn-register:active {
        color: white !important;
        text-decoration: none !important;
    }
    
    /* Centrado adicional para contenedor de botones */
    .navbar .d-flex.justify-content-center {
        width: 100% !important;
    }
    
    /* Responsive para botones */
    @@media (max-width: 767.98px) {
        .navbar .btn-login,
        .navbar .btn-register {
            min-width: 80px !important;
            padding: 0.25rem 0.5rem !important;
            font-size: 0.8rem !important;
            height: 32px !important;
        }
        
        .navbar .btn-login i,
        .navbar .btn-register i {
            font-size: 0.8rem !important;
            margin-right: 0.25rem !important;
        }
    }
    
    @@media (max-width: 479.98px) {
        .navbar .btn-login,
        .navbar .btn-register {
            min-width: 60px !important;
            padding: 0.2rem 0.4rem !important;
            font-size: 0.75rem !important;
            height: 30px !important;
        }
        
        .navbar .btn-login i,
        .navbar .btn-register i {
            font-size: 0.75rem !important;
            margin-right: 0.2rem !important;
        }
    }
</style> 

 
